#!/bin/bash

ENTRIES=`/usr/bin/mysql -u radius -pradius radius -e "select username, count(*) from radusergroup group by username having count(*) <> 1;"`
RET=`echo "$ENTRIES" | /usr/bin/wc -l`

if [ "$ENTRIES" != ""  ]; then
  echo "Device with more than one assigned groups detected"
  echo $ENTRIES
fi

ENTRIES=`/usr/bin/mysql -u radius -pradius radius -e "select username from userinfo where username not in (select username from radusergroup);"`
RET=`echo "$ENTRIES" | /usr/bin/wc -l`

if [ "$ENTRIES" != ""  ]; then
  echo "Devices without any group assignment detected."
  echo $ENTRIES
fi

# TODO
# Devices with multiple userinfo detected